## ðŸš¨ Security Vulnerability: Client-Side API Key Exposure

### Problem Statement

The Gemini API key is currently injected into the client-side React bundle via Vite's `define` mechanism. Since this is a static SPA, the key is visible as **plaintext in the JavaScript bundle** to any visitor using browser DevTools. This exposes the key to:

- Unauthorized API usage and billing exhaustion
- Account suspension by Google
- API scraping by bots (OWASP A02: Cryptographic Failures)

**Severity:** CRITICAL | **CVSS Score:** ~8.2 (High)

### Current Architecture (Vulnerable)

```
Browser â†’ React App (key embedded in JS bundle) â†’ Gemini API
```

### Target Architecture (Secure)

```
Browser â†’ React App â†’ Netlify Serverless Function (key in env) â†’ Gemini API
```

### Acceptance Criteria

- [ ] `VITE_GEMINI_API_KEY` removed from all client-side code
- [ ] A serverless function (`/api/chat`) proxies requests to Gemini
- [ ] API key stored exclusively in Netlify/Vercel env variables (never committed)
- [ ] Client-side bundle no longer contains `@google/genai` SDK
- [ ] Rate limiting + input validation implemented on the proxy endpoint
- [ ] `npm run build` output verified clean via `grep` â€” key not found in dist/

### Technical Implementation Notes

**Recommended: Netlify Functions**

```
netlify/functions/chat.ts
  â†’ Receives { userMessage, chatHistory }
  â†’ Calls Gemini API using process.env.GEMINI_API_KEY
  â†’ Returns { response: string }
```

**Client-side change:**

```ts
// Before (insecure)
import { GoogleGenAI } from "@google/genai"; // remove this SDK

// After (secure)
const res = await fetch('/api/chat', { method: 'POST', body: JSON.stringify({ userMessage }) });
```

**Resolves PRF-001 as a side-effect** â€” removing the SDK reduces client bundle by ~200KB.

### References

- [OWASP A02: Cryptographic Failures](https://owasp.org/Top10/A02_2021-Cryptographic_Failures/)
- [Netlify Functions Docs](https://docs.netlify.com/functions/overview/)
- Resolves: PRF-001 (bundle bloat)
